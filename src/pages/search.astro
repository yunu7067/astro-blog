---
import { AstroSeoProps } from "@components/AstroSeo";
import BaseLayout from '@layouts/BaseLayout.astro';
import config from '../../blog.config.js';
import BlogHeader from "@components/BlogHeader.astro";
import BlogSearch from "src/utils/BlogSearch";
import Search from "@components/Search";

let allPosts = await Astro.glob('./p/**/*.md');
const posts = allPosts.map(p => {
	return {
		id: p.url,
		title: p.frontmatter.title,
		description: p.frontmatter?.description || '',
		tags: p.frontmatter?.tags || []
	};
});

await BlogSearch({ posts });
const flexSearchIndexKeys = [
	"reg",
	"title.cfg", "title.map", "title.ctx",
	"tags.cfg", "tags.map", "tags.ctx",
	"description.cfg", "description.map", "description.ctx",
	"tag", "store"
];

const seo: AstroSeoProps = {
	title: "Search"
}
---

<BaseLayout config={config} seo={seo}>
	<main class="wrapper w-full">
		<div class="max-w-3xl w-full mx-auto">
			<BlogHeader title={config.title} />


			<Search client:only keys={flexSearchIndexKeys} />
		</div>
	</main>
</BaseLayout>